@model MEZBELE.ViewModels.VM
@{
    ViewBag.Title = "Süreç Detayı";
    Layout = "~/Views/Shared/App/_AppLayout.cshtml";
}
<br />
<div class="row">
    <nav>
        <div class="nav-wrapper blue-grey darken-1">
            <div class="col s12">
                <a href="#!" class="breadcrumb">@Model.AktifSurec.Proje.ProjeAdi </a>
                <a href="#!" class="breadcrumb">@Model.AktifSurec.SurecAdi</a>
                <a href="#!" class="breadcrumb">Süreç Detayı</a>
            </div>
        </div>
    </nav>
</div>
<div class="row">
    <div class="col s12">
        <div class="card blue-grey darken-1">
            <div class="card-content white-text">
                <div class="row">
                    <div class="col s10">
                        <span class="card-title">@Model.AktifSurec.SurecAdi - Açıklama</span>
                        <div class="divider"></div><br />
                        <p>
                            @Model.AktifSurec.Aciklama
                        </p>
                    </div>
                    <div class="col s2" style="padding-right:2.5rem;">
                        <div class="row">
                            <span class="badge teal white-text">@DateTime.Parse(Model.AktifSurec.BaslamaTarihi.Value.ToString()).ToShortDateString()</span>
                        </div>
                        <div class="row">
                            <span class="badge red white-text">@DateTime.Parse(Model.AktifSurec.BitisTarihi.Value.ToString()).ToShortDateString()</span>
                        </div>
                        <div class="row">
                            <span class="badge orange white-text">@Model.AktifSurec.Surec1.Count Alt Süreç</span>
                        </div>
                        <div class="row">
                            <span class="badge green white-text">@Model.AktifSurec.Is.Count İş Öğesi</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col s12">
        <div class="card blue-grey darken-1">
            <div class="card-content white-text">
                <div class="row">
                    <div class="col s12">
                        <span class="card-title">@Model.AktifSurec.SurecAdi - Notlar</span>
                        <div class="divider"></div><br />
                        <div class="row">
                            <form class="col s12">
                                <div class="input-field col s12">
                                    <i class="material-icons prefix white-text">mode_edit</i>
                                    <textarea id="surecNotlari" name="Notlar" class="materialize-textarea white-text">@Model.AktifSurec.Notlar</textarea>
                                    <label for="surecNotlari" class="white-text">Notlar</label>
                                </div>
                            </form>
                        </div>
                        <div class="row">
                            <div class="col s12">
                                <a href="#!" class="waves-effect waves-green btn green right" onclick="notuKaydet()">Kaydet</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col s12">
        <div class="card blue-grey darken-1">
            <div class="card-content white-text">
                <div class="row">
                    <div class="col s12">
                        <span class="card-title">@Model.AktifSurec.SurecAdi - İşler & Alt Süreçler</span>
                        <div class="divider"></div><br />
                        <div class="row">
                            <ul class="collapsible blue-grey-text text-darken-1" data-collapsible="accordion">
                                @foreach (var altSurec in Model.AktifSurec.Surec1)
                                {
                                <li>
                                    <div class="collapsible-header">
                                        <div class="row valign-wrapper" style="margin-bottom:-1rem;">
                                            <div class="col s4">
                                                @altSurec.SurecAdi
                                            </div>
                                            <div class="col s1">
                                                @switch (altSurec.Oncelik)
                                                {
                                                    case 1:
                                                <span class="badge green white-text" style="width:2rem">D</span>
                                                        break;
                                                    case 2:
                                                <span class="badge orange white-text" style="width:2rem">O</span>
                                                        break;
                                                    case 3:
                                                <span class="badge red white-text" style="width:2rem">Y</span>
                                                        break;
                                                    default:
                                                        break;
                                                }
                                            </div>
                                            <div class="col s1">
                                                @DateTime.Parse(altSurec.BaslamaTarihi.Value.ToString()).ToShortDateString()
                                            </div>
                                            <div class="col s1">
                                                @DateTime.Parse(altSurec.BitisTarihi.Value.ToString()).ToShortDateString()
                                            </div>
                                            <div class="col s3">
                                                <div class="progress valign pink lighten-3">
                                                    <div class="determinate pink darken-1" style="width:@altSurec.TamamlanmaOrani%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="collapsible-body white">
                                        <ul class="collection">
                                            <li class="collection-item">
                                                <div class="row valign-wrapper" style="margin-bottom:-1rem;">
                                                    <div class="col s5">
                                                        <p class="flow-text">
                                                            <b>#ID</b>
                                                            İş Adı
                                                        </p>
                                                    </div>
                                                    <div class="col s3 pull-s1">
                                                        <span class="badge red white-text">Atanan çalışan avatarları</span>
                                                    </div>
                                                    <div class="col s4">
                                                        <div class="progress valign pink lighten-3">
                                                            <div class="determinate pink darken-1" style="width: 70%"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </li>
                                            <li class="row" style="margin:1rem 0rem;padding-right:1rem;">
                                                <a href="#!" class="waves-effect waves-green btn green right" onclick="isEkle(@altSurec.ID)">İş Ekle</a>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                }
                            </ul>
                            <a href="#!" class="waves-effect waves-green btn green right" onclick="isEkle(@Model.AktifSurec.ID)">İş Ekle</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<script type="text/javascript">
    function notuKaydet() {
        var kontrol = true;
        $('textarea#surecNotlari').each(function () {
            if ($.trim($(this).val()) == "") {
                Materialize.toast(this.name + ' alanı boş bırakılamaz!', 3000, 'red rounded');
                kontrol = false;
                $(this).addClass("invalid");
            } else {
                $(this).removeClass("invalid");
            }
        });

        if (kontrol == true) {
            console.log($("#surecNotlari").val());
        }
    }

    function isEkle(surecKimligi) {
        console.log(surecKimligi);
    }
</script>