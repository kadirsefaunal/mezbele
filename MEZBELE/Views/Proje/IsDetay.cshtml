@model MEZBELE.ViewModels.VM
@{
    ViewBag.Title = "İş Detayı";
    Layout = "~/Views/Shared/App/_AppLayout.cshtml";
}
<br />
<div class="row">
    <nav>
        <div class="nav-wrapper blue-grey darken-1">
            <div class="col s12">
                <a href="/Proje/Detay?projeKimligi=@Model.AktifProje.ID" class="breadcrumb">@Model.AktifSurec.Proje.ProjeAdi </a>
                @if (Model.AktifSurec.Surec2 != null)
                {
                <a href="/Proje/SurecDetay?projeKimligi=@Model.AktifProje.ID&surecKimligi=@Model.AktifSurec.Surec2.ID" class="breadcrumb">@Model.AktifSurec.Surec2.SurecAdi</a>
                }
                <a href="/Proje/SurecDetay?projeKimligi=@Model.AktifProje.ID&surecKimligi=@Model.AktifSurec.ID" class="breadcrumb">@Model.AktifSurec.SurecAdi</a>
                <a href="#!" class="breadcrumb">@Model.AktifIs.IsAdi</a>
                <a href="#!" class="breadcrumb">İş Detayı</a>
            </div>
        </div>
    </nav>
</div>

<div class="row">
    <div class="col s12">
        <div class="card blue-grey darken-1">
            <div class="card-content white-text">
                <div class="row">
                    <div class="col s10">
                        <span class="card-title">@Model.AktifIs.IsAdi - Açıklama</span>
                        <div class="divider"></div><br />
                        <p>
                            @Model.AktifIs.Aciklama
                        </p>
                        <a class="waves-effect waves-light red btn" href="#İsiSil" onclick="isKimligiGetir(@Model.AktifIs.ID)">İşi Sil</a>
                    </div>
                    <div class="col s2" style="padding-right:2.5rem;">
                        <div class="row">
                            <span class="badge teal white-text">@DateTime.Parse(Model.AktifIs.OlusturmaTarihi.Value.ToString()).ToShortDateString()</span>
                        </div>
                        <div class="row">
                            <span class="badge red white-text">@DateTime.Parse(Model.AktifIs.BitisTarihi.Value.ToString()).ToShortDateString()</span>
                        </div>
                        <div class="row">
                            <span class="badge deep-orange white-text">@Model.AktifIs.Surec.Proje.ProjeAdi</span>
                        </div>

                        @if (Model.AktifSurec.Surec2 != null)
                        {
                        <div class="row">
                            <span class="badge indigo darken-2 white-text">@Model.AktifSurec.Surec2.SurecAdi</span>
                        </div>
                        }
                        <div class="row">
                            <span class="badge orange white-text">@Model.AktifIs.Surec.SurecAdi</span>
                        </div>
                        <div class="row">
                            <span class="badge green white-text">@Model.AktifIs.IsKullanici.Count Çalışan</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- İş Silme Modal -->
<div id="İsiSil" class="modal">
    <div class="modal-content">
        <p>@Model.AktifIs.IsAdi adlı işi silmek istediğinizden emin misiniz?</p>
    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat" onclick="isiSil()">Sil</a>
        <a href="#!" class="modal-action modal-close waves-effect waves-red btn-flat">İptal</a>
    </div>
</div>
<!-- İş Silme Modal Sonu -->


<script>
    var isKimlik;
    function isKimligiGetir(isK) {
        isKimlik = isK;
    }

    function isiSil() {
        var isKimligi = {
            isKimligi: isKimlik
        };
        console.log(isKimlik);
        $.post("/Proje/IsiSil", isKimligi, function (cevap) {
            if (cevap == "Başarılı.") {
                Materialize.toast('İş başarıyla silindi.', 3000, 'green rounded');
                window.location("/App/Index");
            } else {
                Materialize.toast('İş silinirken hata!', 3000, 'red rounded');
            }
        });
    }
</script>